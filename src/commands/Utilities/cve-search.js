module.exports = {
	name: "cve-search",
	description: "searchs CVE",
	aliases: ["cve"],
	usage: "sudo cve-search <cve-id>",
	type: "util",
	admin: false,
	run: async (client, message, args) => {
		const Discord = require("discord.js");
		const request = require("request");
		const embed = new Discord.MessageEmbed()
			.setThumbnail(message.author.avatarURL)
			.setTitle(`CVE search results`)
			.setColor(client.serverconfig[message.guild.id].EmbedColor);
		if (!args[0]) {
			var url = "https://cve.circl.lu/api/last";
			request(url, function (err, resp, body) {
				let data = JSON.parse(JSON.stringify(body));
				embed.description = "```";
				let i = 0;
				for (let cve of data) {
					console.log(cve);
					i++;
					if (i == 10) return;
					embed.description += "\n" + cve.name;
				}
				embed.description += "```";
				message.channel.send(embed);
			});
		}
	},
};
